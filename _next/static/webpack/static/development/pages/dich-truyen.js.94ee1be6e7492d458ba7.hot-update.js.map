{"version":3,"file":"static/webpack/static\\development\\pages\\dich-truyen.js.94ee1be6e7492d458ba7.hot-update.js","sources":["webpack:///./components/tuDien/DichTruyenGoogleTransComponent.js"],"sourcesContent":["import React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport pinyin from 'chinese-to-pinyin';\r\nimport translate from 'translation-google';\r\nimport { database } from '../../utils/firebase';\r\nimport { ref, onValue, update, child, get } from \"firebase/database\";\r\n\r\nimport {\r\n  Row,\r\n  Col,\r\n  FormGroup,\r\n  Label,\r\n} from 'reactstrap';\r\nimport axios from 'axios';\r\nimport styled from 'styled-components';\r\nimport TextareaAutosize from 'react-textarea-autosize';\r\nimport Loading from './loader';\r\nimport ChuHan from './ChuHanKhongBacKinh';\r\nimport { chuanHoaChinesseV2, chuanHoaChinneseNoSign, correctTyping, xoaKiTuThuaCopyTuTrang, isEmptyOrBlank, replaceAll, logDebug, logDebug2Val } from '../../utils/utils';\r\nimport DictBook from './dict-book-data'\r\nimport * as GA from \"../../utils/analystics\";\r\n\r\n// var sample = 'Quacking và giết! Nghe những lời của Dao Gushu, vẻ mặt của Shenqi.\\n\\n Mở một mình giống như một con kiến! Nó đã hoàn toàn vượt quá nhận.';\r\nvar sample = '在他左右两边,有七位九成神性境强者。';\r\n\r\nvar pathDictHanVietThayThe = '/static/dictHanVietGoogleTransTaCoNhatKiem.json';\r\nvar pathDictThayThe = '/static/googleTransTaCoNhatKiem.json';\r\n\r\nfunction updateNghiaViet(that) {\r\n  const {typingChinesse, dict} = that.state;\r\n  let nghiaViet = '';\r\n  if(!typingChinesse)\r\n    return;\r\n  nghiaViet = xoaKiTuThuaCopyTuTrang(typingChinesse);\r\n\r\n  for (var word in dict){\r\n    nghiaViet = replaceAll(nghiaViet, word, dict[word].nghia );\r\n  }\r\n\r\n  that.setState({\r\n    nghiaViet,\r\n  });\r\n}\r\n\r\nfunction updateDictThayThe(that, dictThayThe) {\r\n  let {dict} = that.state;\r\n  \r\n  that.setState({\r\n    dict:dictThayThe,\r\n    newNghia: '',\r\n    newWord: '',\r\n    loading: false,\r\n  });\r\n}\r\n\r\nexport default class DictComponent extends Component {\r\n  static async getInitialProps({req}) {\r\n    // Inherit standard props from the Page (i.e. with session data)\r\n    let props = {};\r\n\r\n    // If running on server, perform Async call\r\n    if (typeof window === 'undefined') {\r\n      try {\r\n        props.dictBook = await DictBook.getDictBookData()\r\n        props.dictTruyen = await DictBook.getDictTruyenData()\r\n      } catch (e) {\r\n        props.error = \"Unable to fetch AsyncData on server\"\r\n      }\r\n    }\r\n\r\n    return props\r\n  }\r\n\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    const { words } = props;\r\n\r\n    this.state = {\r\n      loading: true,\r\n      nghiaViet: '',\r\n      typingChinesse: sample,\r\n      chinesse: '',\r\n      doichieu: '',\r\n      hanViet: '',\r\n      bacKinh: '',\r\n      dictHv: {},\r\n      dict: {},\r\n    };\r\n    // axios.get('https://tv.nhidonghocphat.com/dictClient.json').then((res) => {\r\n    // axios.get('https://raw.githubusercontent.com/thanglamhuu/nddhp.github.io/master/dictClient.json').then((res) => {\r\n\r\n    axios.get('/static/baiChuHan.txt').then((res) => {\r\n      this.setState({\r\n        typingChinesse: xoaKiTuThuaCopyTuTrang(res.data),\r\n      });\r\n    });\r\n    this.onChangeHandlerNewHanViet = this.onChangeHandlerNewHanViet.bind(this);\r\n    this.onChangeHandlerNewNghia = this.onChangeHandlerNewNghia.bind(this);\r\n    this.onChangeHandlerChuHan = this.onChangeHandlerChuHan.bind(this);\r\n    this.onChangeHandlerHanViet = this.onChangeHandlerHanViet.bind(this);\r\n    this.onChangeHandlerBacKinh = this.onChangeHandlerBacKinh.bind(this);\r\n    this.onHtmlChangeNghiaViet = this.onHtmlChangeNghiaViet.bind(this);\r\n    this.lamMinVanBan = this.lamMinVanBan.bind(this);\r\n    this.trans = this.trans.bind(this);\r\n    this.updateNghia = this.updateNghia.bind(this);\r\n    this.updateTudien = this.updateTudien.bind(this);\r\n    this.reportNew = this.reportNew.bind(this);\r\n\r\n    this.updateTudien();\r\n\r\n  }\r\n\r\n  onHtmlChangeNghiaViet(e) {\r\n    this.setState({ nghiaViet: e.target.value });\r\n  }\r\n\r\n  onChangeHandlerChuHan(e) {\r\n    this.setState({ typingChinesse: e.target.value });\r\n  }\r\n\r\n  onChangeHandlerHanViet(e) {\r\n    this.setState({ hanViet: correctTyping(e.target.value) });\r\n  }\r\n\r\n  onChangeHandlerNewNghia(e) {\r\n    this.setState({ newNghia: correctTyping(e.target.value) });\r\n  }\r\n\r\n  onChangeHandlerNewHanViet(e) {\r\n    this.setState({ newHanViet: correctTyping(e.target.value) });\r\n  }\r\n\r\n  onChangeHandlerBacKinh(e) {\r\n    this.setState({ bacKinh: correctTyping(e.target.value) });\r\n  }\r\n\r\n  lamMinVanBan() {\r\n    let {typingChinesse, dict} = this.state;\r\n    typingChinesse = xoaKiTuThuaCopyTuTrang(typingChinesse);\r\n\r\n    this.setState({typingChinesse: typingChinesse});\r\n    \r\n    console.log(\"lamMinVanBan\");\r\n\r\n    GA.trackEvent('Dich truyen', 'lam min', 'lam min');\r\n  }\r\n\r\n  reportNew() {\r\n    const {newWord, newHanViet, newNghia} = this.state;\r\n    const json = `{\"chuHan\":\"${newWord}\",\"hanViet\":\"${newHanViet}\",\"bacKinh\":\"${pinyin(newWord)}\",\"nghia\":\"${newNghia}\"},`;\r\n    GA.trackEvent(\"Report\", \"newWord\", json);\r\n    this.setState({newWord:'', newHanViet:'', newNghia:''});\r\n    return json;\r\n  }\r\n\r\n  updateTudien() {\r\n    const dictFb = ref(database, `dictTruyen`);\r\n    onValue(dictFb, (snapshot) => {\r\n      const dict = snapshot.val() || {};\r\n      // console.log('getTkpsgnlListSaga getTkpsgnlSaga onValue', id, data);\r\n      let dictHv = {};\r\n      for (var word in dict){\r\n        dictHv[dict[word].ch]  = dict[word].nghia ;\r\n      }      \r\n      \r\n      console.log('updateTudien ', dictHv);\r\n\r\n      this.setState({\r\n        dict,\r\n        dictHv\r\n      });\r\n    });\r\n\r\n  }\r\n\r\n  trans() {\r\n    let {typingChinesse, chinesse, dict, dictHv} = this.state;\r\n    typingChinesse = xoaKiTuThuaCopyTuTrang(typingChinesse);\r\n    let doichieu = '';\r\n\r\n    for (var word in dictHv){\r\n      typingChinesse = replaceAll(typingChinesse, word, dictHv[word] );\r\n    }\r\n    \r\n    let nghiaViet = '';\r\n    \r\n    translate(typingChinesse, {from:'zh-CN', to: 'vi'}).then(res => {\r\n      nghiaViet = res.text;\r\n\r\n      for (var word in dict){\r\n        nghiaViet = replaceAll(nghiaViet, word, dict[word].nghia );\r\n      }\r\n\r\n      \r\n      //Ghep cau chu Han voi Chu viet\r\n      const cauHans = typingChinesse.split('\\n');\r\n      const cauViets = nghiaViet.split('\\n');\r\n      let cauPos = 0;\r\n      for(cauPos = 0;cauPos<cauHans.length;cauPos++){\r\n        doichieu += cauHans[cauPos] + '\\n' + cauViets[cauPos] + '\\n';\r\n      }\r\n    \r\n      this.setState({\r\n        nghiaViet,\r\n        doichieu,\r\n      });\r\n      \r\n      //=> 这是Google翻译\r\n      console.log('trans', res.from.language.iso);\r\n      this.setState({nghiaViet: nghiaViet});\r\n      //=> en\r\n    }).catch(err => {\r\n        console.error(err);\r\n    });\r\n\r\n    // updateNghiaViet(this);\r\n  }\r\n\r\n  updateNghia(i,nghia){\r\n    let {chinesse} = this.state;\r\n    chinesse[i].nghiaViet = nghia;\r\n    this.setState({chinesse});\r\n    updateNghiaViet(this);\r\n\r\n  }\r\n\r\n  render() {\r\n    const {\r\n      nghiaViet,\r\n      typingChinesse,\r\n      chinesse,\r\n      bacKinh,\r\n      loading,\r\n      dict,\r\n      newWord,\r\n      newHanViet,\r\n      doichieu,\r\n      newNghia\r\n    } = this.state;\r\n\r\n    // Build Cards for Listing\r\n    let chuHans = '', i = 0;\r\n    if (loading) {\r\n      chuHans = <Loading />;\r\n    } else if (chinesse) {\r\n      chuHans = chinesse.map(item => {\r\n        return (\r\n          <ChuHan\r\n            id={i++}\r\n            key={Math.random()}\r\n            chinesse={item.chinesse}\r\n            hanViet={item.hanViet}\r\n            bacKinh={item.bacKinh}\r\n            nghias={item.nghias}\r\n            nghiaViet={item.nghiaViet}\r\n            updateNghia={this.updateNghia}\r\n            dot={item.dot}\r\n          />\r\n        );\r\n      });\r\n    }\r\n\r\n    return (\r\n      <div>\r\n        <Row>\r\n          <h2 className=\"h1Title\">Dịch truyện</h2>\r\n        </Row>\r\n        <Row style={{paddingTop: '10px'}}>\r\n          <a href=\"http://m.qbyqxs.com/xiaoshuo/70022/all.html?sort=-1&page=5\" target=\"_blank\">_Mục Lục</a>\r\n          <a href=\"https://tamlinh247.vn/truyen-hau-due-kiem-than/\" target=\"_blank\">_TamLinh247</a>\r\n          Đối chiếu\r\n          <a href=\"http://m.qbyqxs.com/xiaoshuo/70022/read_39068387.html\" target=\"_blank\">_第七百七十章</a>\r\n          <a href=\"https://tamlinh247.vn/truyen-hau-due-kiem-than/chuong-3376/\" target=\"_blank\">chuong-3376</a>\r\n        </Row>\r\n        <Row>\r\n          <FormGroup style={{width:'100%'}}>\r\n            <Label for=\"inputChuHan\">Nhập nội dung chữ Hán</Label>\r\n            <TextareaAutosize\r\n              className=\"txtAutoSize\"\r\n              id=\"inputChuHan\"\r\n              placeholder=\"Chữ Hán\"\r\n              value={typingChinesse}\r\n              onChange={this.onChangeHandlerChuHan}\r\n            />\r\n          </FormGroup>\r\n        </Row>\r\n        <Row style={{paddingTop: '10px'}}>\r\n          <h3>Kết quả</h3>\r\n          <div style={{width:'70%', textAlign:'center'}}>\r\n            <button className=\"btnProcess\" onClick={this.updateTudien} style={{marginLeft:100}}>Lấy lại từ điển</button>\r\n            <button className=\"btnProcess\" onClick={this.trans} style={{marginLeft:100}}>Lấy kết quả sang nghĩa Việt</button>\r\n          </div>\r\n        </Row>\r\n        <Row style={{paddingTop: '10px'}}>\r\n          <h4>Đối Chiếu</h4>\r\n          <TextareaAutosize\r\n            className=\"txtAutoSize\"\r\n            id=\"inputDoiChieu\"\r\n            placeholder=\"dịch nghĩa\"\r\n            value={doichieu}\r\n            onChange={this.onHtmlChangeNghiaViet}\r\n          />\r\n        </Row>\r\n        <Row style={{paddingTop: '10px'}}>\r\n          <h4>Chỉnh sửa lại nội dung bản dịch tại đây</h4>\r\n          <TextareaAutosize\r\n            className=\"txtAutoSize\"\r\n            id=\"inputNghiaViet\"\r\n            placeholder=\"dịch nghĩa\"\r\n            value={nghiaViet}\r\n            onChange={this.onHtmlChangeNghiaViet}\r\n          />\r\n        </Row>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\n\r\nDictComponent.propTypes = {\r\n  error: PropTypes.string,\r\n  words: PropTypes.shape({\r\n    nghiaViet: PropTypes.string,\r\n    chinesse: PropTypes.string,\r\n    hanViet: PropTypes.string,\r\n    bacKinh: PropTypes.string,\r\n  }),\r\n};\r\n\r\nDictComponent.defaultProps = {\r\n  error: null,\r\n};\r\n\r\nconst mapStateToProps = state => ({\r\n});\r\n\r\nconst mapDispatchToProps = {\r\n};\r\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAEA;AACA;AACA;AACA;AAEA;AAMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AAGA;AACA;AACA;AAAA;AAGA;AACA;AACA;AACA;AACA;AAJA;AAMA;AACA;AACA;;;;;;;;;;;;;AACA;AACA;AACA;AACA;;;;;;;;AAIA;AACA;;AADA;;AACA;AACA;;AADA;;;;;;;AAEA;AACA;;AAGA;AACA;;;;;;;;;;AAEA;AAAA;AACA;AADA;AACA;AAAA;AADA;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AATA;AAYA;AACA;AACA;AACA;AACA;AADA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AArCA;AAsCA;AACA;;;AACA;AACA;AAAA;AAAA;AACA;;;AAEA;AACA;AAAA;AAAA;AACA;;;AAEA;AACA;AAAA;AAAA;AACA;;;AAEA;AACA;AAAA;AAAA;AACA;;;AAEA;AACA;AAAA;AAAA;AACA;;;AAEA;AACA;AAAA;AAAA;AACA;;;AAEA;AAAA;AAAA;AAAA;AAEA;AAEA;AAAA;AAAA;AAEA;AAEA;AACA;;;AAEA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;;;AAEA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAFA;AAIA;AAEA;;;AAEA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAFA;AACA;AACA;AAIA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AAGA;;;AAEA;AAAA;AAEA;AACA;AAAA;AAAA;AACA;AAEA;;;AAEA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAcA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AATA;AAYA;AACA;AACA;AACA;AAGA;AAAA;AAEA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AAEA;AAAA;AAAA;AACA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AACA;AAAA;AAEA;AACA;AACA;AACA;AACA;AALA;AASA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAGA;AACA;AACA;AACA;AACA;AALA;AAQA;AAAA;AAAA;AAAA;AAGA;AACA;AACA;AACA;AACA;AALA;AAUA;;;;AArQA;AACA;AADA;AAmRA;AACA;AADA;AACA;AAGA;AAAA;AAAA;AACA;AAEA;;;;A","sourceRoot":""}